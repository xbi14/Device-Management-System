{% load static %}
<!-- Format keep -->
{%load crispy_forms_tags %}
<!-- Format keep -->
{% include 'chinhsua_modal.html' %}
<!-- Format keep -->
{% include "xacnhanxoact_modal.html" %}
<!-- Format keep -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
      integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
    />
    <link rel="stylesheet" href="../static/css/quanly.css" />
    <title>Trang chủ | Thông tin thiết bị</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-md" style="background-color: #e6e6e6">
      <button
        class="navbar-toggler navbar-toggler-right"
        type="button"
        data-toggle="collapse"
        data-target="#navbarNavDropdown"
        aria-controls="navbarNavDropdown"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <a class="navbar-brand" href="#">
        <img
          src="{% static 'imgs/logo.png' %}"
          width="40"
          height="30"
          class="d-inline-block align-top"
          alt=""
        />
        <span style="font-weight: bold; color: black">Công Ty T&B |</span>
      </a>
      <!-- Site map -->
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="{% url 'QLthietbi_app:render_trangchinh' %}"
            ><i class="fa fa-home" aria-hidden="true"></i> Quản lý thiết bị</a
          >
        </li>
        <li class="breadcrumb-item active" aria-current="page">
          Thông tin thiết bị
        </li>
      </ol>
      <!-- Site map end -->
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item dropdown">
            <a
              class="nav-link dropdown-toggle bg-dark"
              href="#"
              id="navbarDropdownMenuLink"
              data-toggle="dropdown"
            >
              <span class="ml-2" style="color: white"
                >Xin chào, {{user.ten}}</span
              >
            </a>
            <div
              class="dropdown-menu dropdown-menu-right"
              aria-labelledby="navbarDropdownMenuLink"
            >
              <a
              class="dropdown-item"
              href="{% url 'QLthietbi_app:hoso_user' user.id %}"
              >Hồ sơ cá nhân</a
              >
              <a
                class="dropdown-item"
                href="{% url 'QLthietbi_app:capnhap_user' user.id %}"
                >Cập nhập hồ sơ</a
                >
              <a
                class="dropdown-item"
                href="{% url 'QLthietbi_app:doi_matkhau' %}"
                >Đổi mật khẩu</a
                >
              <a
                class="dropdown-item"
                href="{% url 'QLthietbi_app:perform_logout' %}"
                >Đăng xuất</a
              >
            </div>
          </li>
        </ul>
      </div>
    </nav>
    <!-- NavBar END -->
    <!-- Bootstrap row -->
    <div class="row" id="body-row">
      <!-- Sidebar -->
      <div
        id="sidebar-container"
        class="sidebar-expanded d-none d-md-block col-2"
      >
        <!-- d-* hiddens the Sidebar in smaller devices. Its itens can be kept on the Navbar 'Menu' -->
        <!-- Bootstrap List Group -->
        <ul class="list-group sticky-top sticky-offset">
          <!-- Separator with title -->
          <li
            class="list-group-item sidebar-separator-title text-muted d-flex align-items-center menu-collapsed"
          >
            <small>TRANG CHỦ</small>
          </li>
          <!-- /END Separator -->
          <!-- Menu with submenu -->
          <a
            href="#submenu1"
            data-toggle="collapse"
            aria-expanded="false"
            class="bg-dark list-group-item list-group-item-action flex-column align-items-start"
          >
            <div class="d-flex w-100 justify-content-start align-items-center">
              <span class="fa fa-dashboard fa-fw mr-3"></span>
              <span class="menu-collapsed">Quản lý</span>
              <span class="submenu-icon ml-auto"></span>
            </div>
          </a>
          <!-- Submenu content -->
          <div id="submenu1" class="collapse sidebar-submenu">
            <a
              href="{% url 'QLthietbi_app:render_trangchinh' %}"
              class="list-group-item list-group-item-action bg-dark text-white"
            >
              <span class="menu-collapsed">Danh sách thiết bị</span>
            </a>
            <a
              href="{% url 'QLthietbi_app:render_vitri_thietbi' %}"
              class="list-group-item list-group-item-action bg-dark text-white"
            >
              <span class="menu-collapsed">Danh mục</span>
            </a>
          </div>
          <a
            href="#submenu2"
            data-toggle="collapse"
            aria-expanded="false"
            class="bg-dark list-group-item list-group-item-action flex-column align-items-start"
          >
            <div class="d-flex w-100 justify-content-start align-items-center">
              <span class="fa fa-user fa-fw mr-3"></span>
              <span class="menu-collapsed">Tài khoản</span>
              <span class="submenu-icon ml-auto"></span>
            </div>
          </a>
          <!-- Submenu content -->
          <div id="submenu2" class="collapse sidebar-submenu">
            <a
              href="{% url 'QLthietbi_app:hoso_list' %}"
              class="list-group-item list-group-item-action bg-dark text-white"
            >
              <span class="menu-collapsed">Danh sách tài khoản</span>
          </a>
            <a
              href="{% url 'QLthietbi_app:tao_user' %}"
              class="list-group-item list-group-item-action bg-dark text-white"
            >
              <span class="menu-collapsed">Tạo tài khoản</span>
            </a>
          </div>
          <a href="{% url 'QLthietbi_app:render_baocaolist' %}" class="bg-dark list-group-item list-group-item-action">
            <div class="d-flex w-100 justify-content-start align-items-center">
              <span class="fa fa-tasks fa-fw mr-3"></span>
              <span class="menu-collapsed">Báo cáo</span>
            </div>
          </a>
      </div>
      <!-- MAIN -->
      <div class="col py-2">
        <!-- buttons row -->
        <div class="row element-button">
          <div class="col px-3 py-1 pr-1">
            <a
              href="{% url 'QLthietbi_app:render_trangchinh' %}"
              class="btn btn-dark"
              ><i class="fa fa-angle-double-left" aria-hidden="true"></i> Trở
              lại</a
            >
            <a
              href="{% url 'QLthietbi_app:render_chinhsuathietbi' thietbi.id_thiet_bi %}"
              class="btn btn-dark"
              data-target="#suathietbiModal"
              data-toggle="modal"
              ><i class="fa fa-pencil-square-o" aria-hidden="true"></i> Chỉnh
              sửa</a
            >
            <a
              class="btn btn-dark"
              data-target="#confirmDelete1ctModal-{{ pk }}"
              data-toggle="modal"
              ><i class="fa fa-trash-o" aria-hidden="true"></i> Xóa thiết bị</a
            >
          </div>
        </div>
        <!-- buttons row -->
        <!-- content -->
        <br />
        <div class="card">
          <h5 class="card-header bg-dark text-white">
            <i class="fa fa-info-circle" aria-hidden="true"></i>&nbsp Thông tin
            thiết bị {{ pk }}
          </h5>
          <div class="card-body">
            <p class="card-text"></p>
            <div class="row">
              <div class="col-4">
                <img
                  src="{{thietbi.hinh_anh.url}}"
                  alt="Hình ảnh thiết bị"
                  width="500"
                  height="500"
                />
              </div>
              <div class="col-4">
                <i class="fa fa-cube" aria-hidden="true"></i>
                <b>&nbsp Tên thiết bị:</b> {{thietbi.ten_thiet_bi}}
                <hr />
                <i class="fa fa-cubes" aria-hidden="true"></i>
                <!-- Format keep -->
                {% if thietbi.loai_thiet_bi == None %}
                <b>&nbsp Loại thiết bị:</b> Chưa cập nhật loại
                {% else %}
                <b>&nbsp Loại thiết bị:</b> {{thietbi.loai_thiet_bi}}
                {% endif %}
                <hr />
                <i class="fa fa-rss" aria-hidden="true"></i>
                <b>&nbsp Trạng thái: </b>
                {% if thietbi.tinh_trang == "hoatdong" %}
                <!-- Format keep -->
                <span class="badge badge-success"
                  ><i class="fa fa-signal" aria-hidden="true"></i> Hoạt
                  động</span
                >
                <!-- Format keep -->
                {% elif thietbi.tinh_trang == "dangbaotri" %}
                <span class="badge badge-warning"
                  ><i class="fa fa-cog fa-spin fa-fw" aria-hidden="true"></i>
                  Bảo trì</span
                >
                <!-- Format keep -->
                {% else %}
                <!-- Format keep -->
                <span class="badge badge-danger"
                  ><i
                    class="fa fa-spinner fa-pulse fa-fw"
                    aria-hidden="true"
                  ></i>
                  Hỏng</span
                >
                <!-- Format keep -->
                {% endif %}
                <!-- Format keep -->
                <hr />
                <i class="fa fa-map-marker" aria-hidden="true"></i>
                <!-- Format keep -->
                {% if thietbi.phong == None and thietbi.tang == None %}
                <!-- Format keep -->
                <b>&nbsp Vị trí:</b> Chưa cập nhật vị trí
                <!-- Format keep -->
                {% elif thietbi.tang == None and thietbi.phong != None %}
                <!-- Format keep -->
                <b>&nbsp Vị trí:</b> Chưa cập nhật tầng, Phòng {{thietbi.phong}}
                <!-- Format keep -->
                {% elif thietbi.tang != None and thietbi.phong == None %}
                <!-- Format keep -->
                <b>&nbsp Vị trí:</b> Tầng {{thietbi.tang}}, chưa cập nhật phòng
                <!-- Format keep -->
                {% else %}
                <b>&nbsp Vị trí:</b> Tầng {{thietbi.tang}}, Phòng {{thietbi.phong}}
                {% endif %}
                <hr />
                <i class="fa fa-money" aria-hidden="true"></i>
                <b>&nbsp Giá mua:</b> {{ gia_mua_str }} VNĐ
                <hr />
                <i class="fa fa-calendar" aria-hidden="true"></i>
                <b>&nbsp Ngày mua:</b> {{ ngay_mua_str }}
                <hr />
                <i class="fa fa-handshake-o" aria-hidden="true"></i>
                <b>&nbsp Đơn vị cung cấp:</b> {{ thietbi.don_vi_cung_cap }}
                <hr />
                <i class="fa fa-calendar-o" aria-hidden="true"></i>
                <b>&nbsp  Lần cuối bảo trì:</b> {{ ngay_bao_tri_str }}
              </div>
              <div class="col-4">
                <b> Mô tả:</b> {{ thietbi.mo_ta }}
              </div>
            </div>
          </div>
          <!-- card body -->
        </div>
        <!-- card -->
        <!-- content -->
      </div>
      <!-- col row -->
    </div>
    <!-- body row -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script>
      $("#suathietbiform #id_tang").change(function () {
        var url = $("#suathietbiform").attr("data-device-url");
        var tangId = $(this).val();
        /*if (tangId == "") {
          $("#suathietbiform #id_phong").html(
            "<option value=''>---------</option>"
          );
          return;
        }*/
        $.ajax({
          url: url,
          data: {
            tang_id: tangId,
          },
          success: function (data) {
            $("#suathietbiform #id_phong").html(data);
          },
        });
      });
      $.when($("#suathietbiform #id_tang").trigger("change")).done(function (
        sua_data
      ) {
        console.log(sua_data);
      });
    </script>
    {% if form.errors %}
    <script>
      $(document).ready(function () {
        $("#suathietbiModal").modal("show");
      });
    </script>
    {% endif %}
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.bundle.min.js"></script>
    <script>
      // Hide submenus
      $("#body-row .collapse").collapse("hide");

      // Collapse/Expand icon
      $("#collapse-icon").addClass("fa-angle-double-left");

      // Collapse click
      $("[data-toggle=sidebar-colapse]").click(function () {
        SidebarCollapse();
      });

      function SidebarCollapse() {
        $(".menu-collapsed").toggleClass("d-none");
        $(".sidebar-submenu").toggleClass("d-none");
        $(".submenu-icon").toggleClass("d-none");
        $("#sidebar-container").toggleClass(
          "sidebar-expanded sidebar-collapsed"
        );

        // Treating d-flex/d-none on separators with title
        var SeparatorTitle = $(".sidebar-separator-title");
        if (SeparatorTitle.hasClass("d-flex")) {
          SeparatorTitle.removeClass("d-flex");
        } else {
          SeparatorTitle.addClass("d-flex");
        }

        // Collapse/Expand icon
        $("#collapse-icon").toggleClass(
          "fa-angle-double-left fa-angle-double-right"
        );
      }
    </script>
  </body>
</html>
